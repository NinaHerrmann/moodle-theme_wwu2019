{"version":3,"sources":["../src/menu.js"],"names":["init","stickMenu","openMenu","updateMaxMenuHeight","window","resize","mainMenu","topPos","offset","top","sticky","scrollTop","addClass","scroll","removeClass","placeholder","botPos","outerHeight","css","height","openCandidate","openTimeoutId","closeTimeoutId","open","menuItem","close","abortClose","openWithDelay","setTimeout","closeWithDelay","clearTimeout","abortOpen","click","ev","currentTarget","parentNode","menuitems","mouseenter","mouseleave","toggleClass"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage the user menu.\n *\n * @package    theme_wwu2019\n * @copyright  2019 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\n/**\n * Init function\n */\nexport function init() {\n    stickMenu();\n    openMenu();\n\n    updateMaxMenuHeight();\n    $(window).resize(updateMaxMenuHeight);\n}\n\n/**\n * Adds sticky class to main menu nav when needed.\n */\nfunction stickMenu() {\n    const mainMenu = $('#main-menu');\n    const topPos = mainMenu.offset().top;\n    let sticky = $(window).scrollTop() > topPos;\n    if (sticky) {\n        mainMenu.addClass('sticky');\n    }\n    $(window).scroll(() => {\n        if (!sticky && $(window).scrollTop() > topPos) {\n            mainMenu.addClass('sticky');\n            sticky = true;\n        } else if (sticky && $(window).scrollTop() < topPos) {\n            mainMenu.removeClass('sticky');\n            sticky = false;\n        }\n    });\n}\n\n/**\n * Updates max-height of submenus on page-init and window resize.\n */\nfunction updateMaxMenuHeight() {\n    const placeholder = $('#main-menu-placeholder');\n    const botPos = placeholder.offset().top + placeholder.outerHeight() + 24;\n    $('.sub-menu-scroll-container').css('max-height', ($(window).height() - botPos) + 'px');\n}\n\n/**\n * Opens submenu when hovering\n */\nfunction openMenu() {\n    const delay = 300;\n    let openMenu = null;\n    let openCandidate = null;\n    let openTimeoutId = null;\n    let closeTimeoutId = null;\n\n    /**\n     * Opens a menu.\n     * @param {Node} menuItem the menuItem DOM-Element\n     */\n    function open(menuItem) {\n        if (openMenu) {\n            close(openMenu);\n        }\n        abortClose();\n        $(menuItem).addClass('open');\n        openMenu = menuItem;\n        openCandidate = null;\n        openTimeoutId = null;\n    }\n\n    /**\n     * Opens a menu with delay.\n     * @param {Node} menuItem the menuItem DOM-Element\n     */\n    function openWithDelay(menuItem) {\n        openCandidate = menuItem;\n        openTimeoutId = setTimeout(open, delay, menuItem);\n    }\n\n    /**\n     * Closes a menu.\n     * @param {Node} menuItem the menuItem DOM-Element\n     */\n    function close(menuItem) {\n        $(menuItem).removeClass('open');\n        openMenu = null;\n        closeTimeoutId = null;\n    }\n\n    /**\n     * Closes a menu with delay.\n     * @param {Node} menuItem the menuItem DOM-Element\n     */\n    function closeWithDelay(menuItem) {\n        closeTimeoutId = setTimeout(close, delay, menuItem);\n    }\n\n    /**\n     * Aborts the delayed closing of {@link openMenu}\n     */\n    function abortClose() {\n        if (closeTimeoutId) {\n            clearTimeout(closeTimeoutId);\n        }\n    }\n\n    /**\n     * Aborts the delayed opening of {@link openCandidate}\n     */\n    function abortOpen() {\n        openCandidate = null;\n        if (openTimeoutId) {\n            clearTimeout(openTimeoutId);\n        }\n    }\n\n    $('li.main-menu-item > a').click((ev) => {\n        if (ev.currentTarget.parentNode === openMenu) {\n            close(openMenu);\n        } else {\n            open(ev.currentTarget.parentNode);\n        }\n    });\n\n    let menuitems = $('li.main-menu-item');\n    menuitems.mouseenter((ev) => {\n        if (ev.currentTarget === openMenu) {\n            abortClose();\n        } else {\n            openWithDelay(ev.currentTarget);\n        }\n    });\n    menuitems.mouseleave((ev) => {\n        if (openCandidate && ev.currentTarget === openCandidate) {\n            abortOpen();\n        }\n        if (openMenu && ev.currentTarget === openMenu) {\n            closeWithDelay(ev.currentTarget);\n        }\n    });\n\n    $('li.sub-menu-item > a').click((ev) => {\n        $(ev.currentTarget.parentNode).toggleClass('open');\n    });\n\n    $('li.sub-sub-menu-item > a').click((ev) => {\n        $(ev.currentTarget.parentNode).toggleClass('open');\n    });\n}"],"file":"menu.min.js"}